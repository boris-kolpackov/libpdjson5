test.options = --json5

: comma
:
{{
  : array
  :
  $* <<EOI >>EOO
  [
    1,
    2,
  ]
  EOI
    1,  1: [
    2,  3:   1
    3,  3:   2
    4,  1: ]
  EOO

  : array-empty
  :
  $* <<EOI >>EOO 2>>EOE !=0
  [
    ,
  ]
  EOI
    1,  1: [
  EOO
  <stdin>:2:3: error: unexpected byte ',' in value
  EOE

  : object
  :
  $* <<EOI >>EOO
  {
    "foo": 1,
    "bar": 2,
  }
  EOI
    1,  1: {
    2,  3:   foo
    2, 10:   1
    3,  3:   bar
    3, 10:   2
    4,  1: }
  EOO

  : object-empty
  :
  $* <<EOI >>EOO 2>>EOE !=0
  {
    ,
  }
  EOI
    1,  1: {
  EOO
  <stdin>:2:3: error: unexpected byte ',' in value
  EOE

  : object-after-name
  :
  $* <<EOI >>EOO 2>>EOE !=0
  {
    "foo" ,
  }
  EOI
    1,  1: {
    2,  3:   foo
  EOO
  <stdin>:2:9: error: expected ':' after member name
  EOE
}}

: comments
:
{{
  : block
  :
  $* <<EOI >>EOO
  /*x
    y*/
  /*x*/{/*x*/
    /*x*/
    /*x*/"a"/*x*/:/*x*/123/*x*/,/*x*/
    /*x*/
    /*x*//*x*/"b"/*x*//*x*/:/*x*/  /*x*/"abc"/*x*//*x*/,/*x*//*x*/
    /*x*/
    /*x*/"c"/*x*/:/*x*/ [/*x*/1/*x*/,/*x*/2/*x*/]/*x*/,/*x*/
    /*x*/
    /*x*/"d"/*x*/:/*x*/{/*x*/"x"/*x*/:/*x*/true/*x*/}/*x*/
  /*x*//*x*/
  /*x*/}/*x*/
  /*x*/
  /*x*/
  EOI
    3,  6: {
    5,  8:   a
    5, 22:   123
    7, 13:   b
    7, 39:   "abc"
    9,  8:   c
    9, 23:   [
    9, 29:     1
    9, 41:     2
    9, 47:   ]
   11,  8:   d
   11, 22:   {
   11, 28:     x
   11, 42:     <true>
   11, 51:   }
   13,  6: }
  EOO

  : line
  :
  $* <<EOI >>EOO
  //x
  //x
  {//x
    //x
    "a": 123,//x
    "b": "abc", //x
    "c":  //x
    //x
    [//x
      //x
      1//x
      //x
      ,//x
      2//x
    //x
    ]//x
    //x
    ,//x
    //x
    "d"//x
    //x
    ://x
    //x
    {//x
    "x" : true}//x
  //x
  }//x
  //x
  //x
  EOI
    3,  1: {
    5,  3:   a
    5,  8:   123
    6,  3:   b
    6,  8:   "abc"
    7,  3:   c
    9,  3:   [
   11,  5:     1
   14,  5:     2
   16,  3:   ]
   20,  3:   d
   24,  3:   {
   25,  3:     x
   25,  9:     <true>
   25, 13:   }
   27,  1: }
  EOO

  : mixed
  :
  $* <<EOI >>EOO
  //x
  /*x*/{//x
    /*x*/"a": 123,/*x*///x
    /*x*/"b": "abc", /*x*/ //x
    /*x*/"c": [1, 2],// /*
    /*x*/"d": {"x": true}/*x*/
  //x
  //x
  /*x
    y*/}//x
  //x
  /*x*/
  //x
  EOI
    2,  6: {
    3,  8:   a
    3, 13:   123
    4,  8:   b
    4, 13:   "abc"
    5,  8:   c
    5, 13:   [
    5, 14:     1
    5, 17:     2
    5, 18:   ]
    6,  8:   d
    6, 13:   {
    6, 14:     x
    6, 19:     <true>
    6, 23:   }
   10,  6: }
  EOO

  : streaming
  :
  $* --streaming <<EOI >>EOO
  1/* comment */2
  /*comment*/
  3// comment
  4
  /*comment*///comment
  /*comment*/
  /**/5
  EOI
    1,  1: 1
    1, 15: 2
    3,  1: 3
    4,  1: 4
    7,  5: 5
  EOO

  : line-dangling
  :
  $* <:'2//x' >>EOO
    1,  1: 2
  EOO

  : block-dangling
  :
  $* <<EOI 2>>EOE !=0
  /*/ 2
  EOI
  <stdin>:2:0: error: unexpected end of text before '*/'
  EOE
}}
